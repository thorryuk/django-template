{% extends 'pln/backend/layout/base_layout.html' %}
{% load  static %}

{% block css %}
    <link rel="stylesheet" href="{% static '/assets/vendor_components/select2/dist/css/select2.min.css' %}">
{% endblock %}

{% block javascript %}

    <script src="{% static '/assets/vendor_components/select2/dist/js/select2.full.js' %}"></script>
    <script src="{% static '/assets/vendor_plugins/input-mask/jquery.inputmask.js' %}"></script>
    <script src="{% static '/assets/vendor_plugins/input-mask/jquery.inputmask.date.extensions.js' %}"></script>
    <script src="{% static '/assets/vendor_plugins/input-mask/jquery.inputmask.extensions.js' %}"></script>
    <script src="{% static '/assets/vendor_components/moment/min/moment.min.js' %}"></script>
    <script src="{% static '/assets/vendor_components/bootstrap-daterangepicker/daterangepicker.js' %}"></script>
    <script src="{% static '/assets/vendor_components/bootstrap-colorpicker/dist/js/bootstrap-colorpicker.min.js' %}"></script>
    <script src="{% static '/assets/vendor_plugins/timepicker/bootstrap-timepicker.min.js' %}"></script>
    <script src="{% static '/assets/vendor_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js' %}"></script>
    <script src="{% static '/assets/vendor_plugins/iCheck/icheck.min.js' %}"></script>
    <script src="{% static 'js/pages/advanced-form-element.js'%}"></script>
    <script src="{% static '/assets/vendor_components/jquery-ui/jquery-ui.min.js' %}"></script>
    <script src="{% static '/assets/vendor_components/datatables.net/js/jquery.dataTables.min.js' %}"></script>
    <script src="{% static '/assets/vendor_components/datatables.net-bs/js/dataTables.bootstrap.min.js' %}"></script>
    <script src="{% static '/assets/vendor_plugins/DataTables-1.10.15/media/js/jquery.dataTables.min.js' %}"></script>

    <script>
        var data_table = null;
        $(function () {
            "use strict";

            $('.select2').select2();
    
            data_table = $('#userJobList').DataTable({
                'paging'      : true,
                'lengthChange': false,
                'searching'   : false,
                'autoWidth'   : false,
                'processing': true,
                'serverSide': true,
                'ajax': {
                    url: "{% url 'job_user_list_ajax' %}",
                    data : function(d){
                        d.jobID             = $('#job_id').val();
                        d.name              = $('#applicant_name').val();
                        d.major             = $('#applicant_major').val();
                        d.age_from          = $('#applicant_age_from').val();
                        d.age_to            = $('#applicant_age_to').val();
                        d.education_from    = $('#applicant_education_from').val();
                        d.education_to      = $('#applicant_education_to').val();
                        d.work_experience   = $('#applicant_work_experience').val();
                    }
                  },
                'ordering': false
            });
    
        }); // End of use strict

        $(document).ready(function () {
            $('#filter').click(function () {
                data_table.draw();
            });
            $('#reset').click(function () {
                // data_table.ajax.reload();
                location.reload();
            });
        });
    </script>
{% endblock %}

{% block content %}
    {% if request.COOKIES.success_msg %}
        <div class="alert alert-success alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
            {{ request.COOKIES.success_msg }} </div>
    {% endif %}

    {% if request.COOKIES.error_msg %}
        <div class="alert alert-danger alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
            {{ request.COOKIES.error_msg }} </div>
    {% endif %}

    <div class="box box-default">
        <!-- /.box-header -->
        <div class="box-body">
            <!-- Nav tabs -->
            <ul class="nav nav-tabs" role="tablist">
                
                {% if request.user.roleuser.role_group.name != 'departement' %}
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'job_detail' id=id_job%}" role="tab" aria-selected="false">
                    <span class="hidden-sm-up">
                                <i class="ion-home"></i>
                            </span>
                    <span class="hidden-xs-down">Detail Job</span>
                    </a>
                </li>
                {% endif %}
                    
                <li class="nav-item">
                    <a class="nav-link active show" href="#" role="tab" aria-selected="true">
                            <span class="hidden-sm-up">
                                <i class="ion-person"></i>
                            </span>
                        <span class="hidden-xs-down">Job Applicant</span>
                    </a>
                </li>
                <!-- <li class="nav-item">
                    <a class="nav-link" href="{% url 'job_detail' id=id_job%}" role="tab" aria-selected="true">
                    <span class="hidden-sm-up">
                                <i class="ion-home"></i>
                            </span>
                    <span class="hidden-xs-down">Interview List</span>
                    </a>
                </li> -->
            </ul>

            <!-- Tab panes -->
            <div class="tab-content tabcontent-border">
                <!-- {% csrf_token %} -->
                <div class="tab-pane active show" id="profile" role="tabpanel">
                    <div class="pad">
                        <h3>Job Applicant List</h3>
                        <div class="box-header with-border table-responsive">
                            <form action="#" method="post" target="_blank">
                                {% csrf_token %}
                                <div class="row">
                                    <div class="col-md-3 col-6">
                                        <div class="form-group">
                                            <label>Name : </label>
                                            <div class="controls">
                                                <input type="text" name="applicant_name" id="applicant_name" class="form-control" autocomplete="off"/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3 col-6">
                                        <div class="form-group">
                                            <label>Major : </label>
                                            <div class="controls">
                                                <select class="form-control select2 w-p100" name="applicant_major" id="applicant_major">
                                                    <option value="">--- Major --- </option>
                                                    {% for prodi in jurusan %}
                                                        <option value="{{ prodi.name }}">{{ prodi.name }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                    
                                    <div class="col-md-3 col-6">
                                        <div class="form-group">
                                            <label>Age From : </label>
                                            <div class="controls">
                                                <input id="applicant_age_from" name="applicant_age_from" class="form-control" autocomplete="off"/>
                                            </div>
                                        </div>
                                    </div>
                
                                    <div class="col-md-3 col-6">
                                        <div class="form-group">
                                            <label>To : </label>
                                            <div class="controls">
                                                <input id="applicant_age_to" name="applicant_age_to" class="form-control" autocomplete="off"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-3 col-6">
                                        <div class="form-group">
                                            <label>Education From : </label>
                                            <div class="controls">
                                                <select class="form-control select2 w-p100" name="applicant_education_from" id="applicant_education_from">
                                                    <option value="">--- Education Level --- </option>
                                                    {% for level in pendidikan %}
                                                        <option value="{{ level.id }}">{{ level.name }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                
                                    <div class="col-md-3 col-6">
                                        <div class="form-group">
                                            <label>To : </label>
                                            <div class="controls">
                                                <select class="form-control select2 w-p100" name="applicant_education_to" id="applicant_education_to">
                                                    <option value="">--- Education Level --- </option>
                                                    {% for level in pendidikan %}
                                                        <option value="{{ level.id }}">{{ level.name }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-3 col-6">
                                        <div class="form-group">
                                            <label>Work Experience : </label>
                                            <div class="controls">
                                                <input id="applicant_work_experience" name="applicant_work_experience" class="form-control" autocomplete="off"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-1 col-9">
                                        <div class="form-group">
                                            <label></label>
                                            <div class="controls">
                                                <button type="button" class="btn btn-success pull-left" id="filter">
                                                    <i class="fa fa-search"></i>
                                                    Filter
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- &nbsp;
                                    <div class="col-md-1 col-9">
                                        <div class="form-group">
                                            <label></label>
                                            <div class="controls">
                                                <button type="button" class="btn btn-warning pull-left">
                                                    <i class="fa fa-download"></i>
                                                    Download
                                                </button>
                                            </div>
                                        </div>
                                    </div> -->
                                    &nbsp;
                                    &nbsp;
                                    <div class="col-md-1 col-9">
                                        <div class="form-group">
                                            <label></label>
                                            <div class="controls">
                                                <button type="reset" class="btn btn-light pull-right" id="reset">
                                                    <i class="fa fa-repeat"></i>
                                                    Reset
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <input type="hidden" id="job_id" name="job_id" value="{{ id_job }}" />
                        <div class="row" style="margin-bottom: 10px;">
                            <div class="col-md-12 col-12" style="margin-top: 10px;">
                                <div class="table-responsive">
                                    <table id="userJobList" class="table no-wrap" data-page-size="10">
                                        <thead>
                                        <tr class="bg-secondary">
                                            <th>Name</th>
                                            <th>Age</th>
                                            <th>Education</th>
                                            <th>Major</th>
                                            <th>Certificate</th>
                                            <th>Work Experience</th>
                                            <th>Send to Departement</th>
                                            <th>Potential</th>
                                            <th>Process</th>
                                            <th>Score</th>
                                            <th style="width: 230px;">Action</th>
                                        </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>

                                <!-- /. box -->
                            </div>
                            <!-- /.col -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /.box-body -->
    </div>
{% endblock %}